# Green Stock Analysis
A tool to analyze stocks based on annual data.

## Overview of Project
Steve's parents are looking to invest in stocks for Green Energy and Steve, who is a recently graduated Finance major, has offered to help. Steve wanted a tool to be able to compare Green Stocks based on annual data.

### Purpose
While this project is fairly specific, the method to analyze the data can be applied to a far broader range of data. Since the data can be formatted the same for different stocks and subsequent years' data, the project was completed by creating VBA macros. This means that any stocks for any year can be analyzed using these VBA scripts.

## Results
In the sections below, I will provide in-depth analysis of the data.

### 2017 Green Stocks Analysis
Overall, 2017 was a great year for Green Energy stocks. DQ topped the charts with a staggering 200% increase during the calendar year, while only one of the 12 stocks that were analyzed had a lower closing price than open price.

![2017 Green Energy stocks](https://github.com/cdeanatx/stock-analysis/blob/main/Resources/VBA_Challenge_2017.png)

### 2018 Green Stocks Analysis
In 2018, the Green Energy stocks suffered for the most part, with the exception of RNPH and RUN, who actually grew their stock prices by over 80% year over year. DQ stock prices were hit particularly hard, suffering the greatest decrease (62.6%) of any of the 12 stocks that were analyzed.

![2018 Green Energy stocks](https://github.com/cdeanatx/stock-analysis/blob/main/Resources/VBA_Challenge_2018.png)

## Summary
Below are thoughts on the refactorization of code.

### General Thoughts on the Refactorization of Code
I think refactoring code can be an integral part of a project, depending on its scope. For a project covering a dataset whose parameters can be widened to a degree that could create hundreds of thousands of datapoints, refactorization is certainly worth the time and effort. However, when working on a limited dataset without the potential for considerable growth, especially if the project is on a tight deadline, the extra seconds it takes a program to run will likely be far less impactful than the extra time it would take a programmer to refactor.

### Refactorization as it Applies to this Project
Most of the refactoring that occurred between the two versions of the VBA script were well worth the time and effort. My original script was slightly different from the one generated by the module. Instead of hard coding the tickers, I performed an initial loop (code block shown below) through the dataset and created an array of tickers. There were both advantages and disadvantages to this technique.

```    
numTickers = 0
'currTicker must be initialized so first loop iteration will update its value
currTicker = ""
'initialize string array with no size so its size can be updated each time a new ticker is found
Dim tickerList() As String
    
'Loop through rows to identify different tickers
For i = 2 To RowEnd
 
    'Conditional that identifies new tickers
    If Cells(i, 1) <> currTicker Then
        
        currTicker = Cells(i, 1)
            
        'Re-size array and input ticker value in current index | determined syntax from https://www.vbforums.com/showthread.php?88161-Can-I-declare-an-array-with-unknown-size
        ReDim Preserve tickerList(numTickers)
        tickerList(numTickers) = currTicker
          
        numTickers = numTickers + 1
        
    End If
    
Next i
```

#### Advantages:
- My original VBA script could have been run for a dataset containing hundreds of different stocks.
- If stocks were added or removed from the list year over year, my original script would still have provided accurate data.

#### Disadvantages
- My original script, while more flexible, cost far more resources to run and took about 4x longer.
- For a larger dataset, which the scope of this project could certainly be expanded to, my script could end up taking minutes or even hours to run.
